# CivitAI Downloader v2 ドキュメント

## プロジェクト概要

CivitAI Downloader v2は、CivitAI.comからAIモデルを効率的にダウンロードするためのPythonアプリケーションです。大規模データセットの処理、セキュリティ、パフォーマンスを重視した設計となっています。

## アーキテクチャ

3層アーキテクチャを採用し、以下の構成となっています：

- **API層**: 外部インターフェース、REST API、CLI
- **Core層**: ビジネスロジック、サービス、ドメインモデル  
- **Data層**: データアクセス、モデル、永続化

## 開発手法

- **TDD（テスト駆動開発）**: Red-Green-Refactor サイクル
- **型安全性**: Pydantic V2、Type Hints
- **クリーンアーキテクチャ**: 疎結合、単一責任原則

## フェーズ別実装ドキュメント

### ✅ 完了済み

#### [Phase 1: 基盤システム](./phase-1-foundation-systems.md)
- **期間**: 2025年1月19日
- **テスト**: 49個合格 ✅
- **内容**: 
  - 3層アーキテクチャ構築
  - 抽象インターフェース定義
  - メモリ管理システム
  - 統一エラー処理システム
  - 設定管理システム
  - データモデル（Pydantic V2）

### 🔄 実装予定

#### Phase 2: API層実装
- REST APIエンドポイント
- リクエスト/レスポンス処理
- 認証・認可システム

#### Phase 3: Core層実装
- ビジネスロジック
- サービス層
- ドメインモデル

#### Phase 4: Data層実装
- データベース接続
- リポジトリパターン
- データ永続化

#### Phase 5: ダウンロード機能
- 並行ダウンロード
- 進捗追跡
- 再開機能

#### Phase 6: CLI実装
- コマンドライン引数解析
- インタラクティブモード
- プログレスバー

#### Phase 7: 統合テスト
- エンドツーエンドテスト
- パフォーマンステスト
- セキュリティテスト

## テスト戦略

### 単体テスト
- TDD手法によるテストファースト開発
- 高いテストカバレッジ維持
- エッジケースの網羅

### 統合テスト
- API連携テスト
- ダウンロード機能テスト
- セキュリティテスト

## セキュリティ考慮事項

### ファイル形式
- **SafeTensors**: 優先サポート（安全）
- **Pickle**: 条件付きサポート（セキュリティスキャン必須）

### 認証
- API Key管理
- SSL証明書検証
- レート制限

## パフォーマンス

### 大規模データ対応
- 10,000個以上のモデル処理
- ストリーミング処理
- メモリ効率最適化

### 並行処理
- 非同期処理（async/await）
- 並行ダウンロード
- スレッドセーフ設計

## 技術スタック

- **言語**: Python 3.11+
- **データ検証**: Pydantic V2
- **テスト**: pytest
- **設定管理**: YAML + 環境変数
- **型チェック**: Type Hints
- **アーキテクチャ**: Clean Architecture

## 貢献方法

1. TDD手法に従った開発
2. 型ヒントの適切な使用
3. ドキュメントの更新
4. セキュリティ考慮事項の遵守

## ライセンス

[ライセンス情報は後日追加]

---

**最終更新**: 2025年1月19日  
**ドキュメント作成者**: Claude Code  
**プロジェクト状況**: Phase 1 完了 ✅